{"version":3,"file":"input.js","sources":["../../../src/components/power-select/input.ts"],"sourcesContent":["import Component from '@glimmer/component';\nimport { runTask } from 'ember-lifeline';\nimport { action } from '@ember/object';\nimport { modifier } from 'ember-modifier';\nimport type { Select, TSearchFieldPosition } from '../power-select';\n\ninterface PowerSelectInputSignature {\n  Element: HTMLElement;\n  Args: {\n    select: Select;\n    ariaLabel?: string;\n    ariaLabelledBy?: string;\n    ariaDescribedBy?: string;\n    role?: string;\n    searchPlaceholder?: string;\n    searchFieldPosition?: TSearchFieldPosition;\n    ariaActiveDescendant?: string;\n    listboxId?: string;\n    onKeydown: (e: KeyboardEvent) => false | void;\n    onBlur: (e: FocusEvent) => void;\n    onFocus: (e: FocusEvent) => void;\n    onInput: (e: InputEvent) => boolean;\n    autofocus?: boolean;\n  };\n}\n\nexport default class PowerSelectInput extends Component<PowerSelectInputSignature> {\n  didSetup: boolean = false;\n\n  @action\n  handleKeydown(e: KeyboardEvent): false | void {\n    if (this.args.onKeydown(e) === false) {\n      return false;\n    }\n    if (e.keyCode === 13) {\n      this.args.select.actions.close(e);\n    }\n  }\n\n  @action\n  handleInput(event: Event): false | void {\n    const e = event as InputEvent;\n    if (this.args.onInput(e) === false) {\n      return false;\n    }\n  }\n\n  @action\n  handleBlur(event: Event) {\n    if (this.args.searchFieldPosition === 'trigger') {\n      this.args.select.actions?.search('');\n    }\n\n    this.args.onBlur(event as FocusEvent);\n  }\n\n  setupInput = modifier(\n    (el: HTMLElement) => {\n      if (this.didSetup) {\n        return;\n      }\n\n      this.didSetup = true;\n\n      this._focusInput(el);\n\n      return () => {\n        this.args.select.actions?.search('');\n      };\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  private _focusInput(el: HTMLElement) {\n    runTask(\n      this,\n      () => {\n        if (this.args.autofocus !== false) {\n          el.focus();\n        }\n      },\n      0,\n    );\n  }\n}\n"],"names":["PowerSelectInput","Component","didSetup","handleKeydown","e","args","onKeydown","keyCode","select","actions","close","n","prototype","action","handleInput","event","onInput","handleBlur","searchFieldPosition","search","onBlur","setupInput","modifier","el","_focusInput","eager","runTask","autofocus","focus","setComponentTemplate","TEMPLATE"],"mappings":";;;;;;;;;;AA0Be,MAAMA,gBAAgB,SAASC,SAAS,CAA4B;AACjFC,EAAAA,QAAQ,GAAY,KAAK;EAGzBC,aAAaA,CAACC,CAAgB,EAAgB;IAC5C,IAAI,IAAI,CAACC,IAAI,CAACC,SAAS,CAACF,CAAC,CAAC,KAAK,KAAK,EAAE;AACpC,MAAA,OAAO,KAAK;AACd;AACA,IAAA,IAAIA,CAAC,CAACG,OAAO,KAAK,EAAE,EAAE;MACpB,IAAI,CAACF,IAAI,CAACG,MAAM,CAACC,OAAO,CAACC,KAAK,CAACN,CAAC,CAAC;AACnC;AACF;AAAC,EAAA;IAAAO,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,eAAA,EAAA,CARAC,MAAM,CAAA,CAAA;AAAA;EAWPC,WAAWA,CAACC,KAAY,EAAgB;IACtC,MAAMX,CAAC,GAAGW,KAAmB;IAC7B,IAAI,IAAI,CAACV,IAAI,CAACW,OAAO,CAACZ,CAAC,CAAC,KAAK,KAAK,EAAE;AAClC,MAAA,OAAO,KAAK;AACd;AACF;AAAC,EAAA;IAAAO,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,aAAA,EAAA,CANAC,MAAM,CAAA,CAAA;AAAA;EASPI,UAAUA,CAACF,KAAY,EAAE;AACvB,IAAA,IAAI,IAAI,CAACV,IAAI,CAACa,mBAAmB,KAAK,SAAS,EAAE;MAC/C,IAAI,CAACb,IAAI,CAACG,MAAM,CAACC,OAAO,EAAEU,MAAM,CAAC,EAAE,CAAC;AACtC;AAEA,IAAA,IAAI,CAACd,IAAI,CAACe,MAAM,CAACL,KAAmB,CAAC;AACvC;AAAC,EAAA;IAAAJ,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,YAAA,EAAA,CAPAC,MAAM,CAAA,CAAA;AAAA;AASPQ,EAAAA,UAAU,GAAGC,QAAQ,CAClBC,EAAe,IAAK;IACnB,IAAI,IAAI,CAACrB,QAAQ,EAAE;AACjB,MAAA;AACF;IAEA,IAAI,CAACA,QAAQ,GAAG,IAAI;AAEpB,IAAA,IAAI,CAACsB,WAAW,CAACD,EAAE,CAAC;AAEpB,IAAA,OAAO,MAAM;MACX,IAAI,CAAClB,IAAI,CAACG,MAAM,CAACC,OAAO,EAAEU,MAAM,CAAC,EAAE,CAAC;KACrC;GACF;AACD;AACA;AACA,EAAA;AAAEM,IAAAA,KAAK,EAAE;AAAM,GACjB,CAAC;EAEOD,WAAWA,CAACD,EAAe,EAAE;IACnCG,OAAO,CACL,IAAI,EACJ,MAAM;AACJ,MAAA,IAAI,IAAI,CAACrB,IAAI,CAACsB,SAAS,KAAK,KAAK,EAAE;QACjCJ,EAAE,CAACK,KAAK,EAAE;AACZ;KACD,EACD,CACF,CAAC;AACH;AACF;AAACC,oBAAA,CAAAC,QAAA,EA5DoB9B,gBAAgB,CAAA;;;;"}